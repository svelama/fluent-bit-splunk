---
# Test application in team-alpha namespace
# Consumer application - logs will be sent to Mock Splunk Consumer
apiVersion: v1
kind: Pod
metadata:
  name: test-app-alpha
  namespace: team-alpha
  labels:
    app: test-app
    team: alpha
    environment: test
    consumer-splunk-index: "alpha-consumer-index"  # This routes logs to consumer-logs
spec:
  containers:
  - name: app
    image: busybox:latest
    command: ["/bin/sh", "-c"]
    args:
    - |
      echo "Starting test-app-alpha..."
      i=0
      while true; do
        i=$((i+1))
        echo "{\"timestamp\":\"$(date -Iseconds)\",\"level\":\"INFO\",\"message\":\"Log from team-alpha consumer application\",\"counter\":$i,\"team\":\"alpha\"}"
        sleep 5
      done
    resources:
      limits:
        memory: 64Mi
      requests:
        cpu: 10m
        memory: 32Mi
---
# Test application in team-beta namespace
# Consumer application - logs will be sent to Mock Splunk Consumer
apiVersion: v1
kind: Pod
metadata:
  name: test-app-beta
  namespace: team-beta
  labels:
    app: test-app
    team: beta
    environment: test
    consumer-splunk-index: "beta-consumer-index"  # This routes logs to consumer-logs
spec:
  containers:
  - name: app
    image: busybox:latest
    command: ["/bin/sh", "-c"]
    args:
    - |
      echo "Starting test-app-beta..."
      i=0
      while true; do
        i=$((i+1))
        echo "{\"timestamp\":\"$(date -Iseconds)\",\"level\":\"INFO\",\"message\":\"Log from team-beta consumer application\",\"counter\":$i,\"team\":\"beta\"}"
        sleep 5
      done
    resources:
      limits:
        memory: 64Mi
      requests:
        cpu: 10m
        memory: 32Mi
---
# Test application in team-gamma namespace
# Infrastructure logs - will be sent to Mock Splunk Infrastructure
apiVersion: v1
kind: Pod
metadata:
  name: test-app-gamma
  namespace: team-gamma
  labels:
    app: test-app
    team: gamma
    environment: test
    # Note: No consumer-splunk-index label, so logs go to tdp-infra
spec:
  containers:
  - name: app
    image: busybox:latest
    command: ["/bin/sh", "-c"]
    args:
    - |
      echo "Starting test-app-gamma..."
      i=0
      while true; do
        i=$((i+1))
        echo "{\"timestamp\":\"$(date -Iseconds)\",\"level\":\"INFO\",\"message\":\"Log from team-gamma infrastructure application\",\"counter\":$i,\"team\":\"gamma\"}"
        sleep 5
      done
    resources:
      limits:
        memory: 64Mi
      requests:
        cpu: 10m
        memory: 32Mi
